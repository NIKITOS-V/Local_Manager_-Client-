#:set messages_panel_size_hint_y 0.85
#:set top_panel_size_hint_y 0.05
#:set send_message_panel_size_hint_y 1 - messages_panel_size_hint_y - top_panel_size_hint_y

#:set message_input_size_hint_x 0.9

<ChatScreen>:
    canvas:
        Color:
            rgba: self.bg_color

        Rectangle:
            size: self.size

    BoxLayout:
        id: main_box_layout
        padding: 5
        spacing: 5
        orientation: "vertical"

        BoxLayout:
            orientation: "horizontal"
            padding: 2
            size_hint: 1, top_panel_size_hint_y

            Button:
                size_hint: 0.2, 1
                background_active: ""
                background_normal: ""
                text: "Выйти"
                font_size: self.height * 0.5
                background_color: root.button_active_color if self.state == "active" else root.button_normal_color
                on_press: root.disconnect()

            Widget:

        MessagesPanel:
            id: messages_panel
            font_size: root.text_size
            multiline: True
            readonly: True
            background_active: ""
            background_normal: ""
            background_color: self.bg_color
            foreground_color: self.fg_color
            size_hint: 1, messages_panel_size_hint_y

        BoxLayout:
            spacing: main_box_layout.spacing
            orientation: "horizontal"
            size_hint: 1, send_message_panel_size_hint_y

            TextInput:
                id: input_message
                font_size: root.text_size
                multiline: True
                background_active: ""
                background_normal: ""
                background_color: root.message_input_color
                foreground_color: root.text_color
                size_hint: message_input_size_hint_x, 1
                on_size: root.text_size = round(self.height * 0.25)

            SendMessageButton:
                size_hint: None, 1
                width: self.height
                background_active: ""
                background_normal: ""
                background_color: root.button_active_color if self.state == "active" else root.button_normal_color
                on_press: root.send_message(input_message)
